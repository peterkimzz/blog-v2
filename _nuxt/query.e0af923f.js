import{z as m,A as k,B as C,C as g,j as O,f as A,i as S,D as B,E as R,l as P,G as T,H as j,I as L,_ as I}from"./entry.05eb57b8.js";import{h as _,u as q}from"./preview.d255b37e.js";import{w as v,s as z}from"./utils.38b28f51.js";const F=()=>null;function H(...t){const r=typeof t[t.length-1]=="string"?t.pop():void 0;typeof t[0]!="string"&&t.unshift(r);let[e,a,n={}]=t;if(typeof e!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof a!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");n.server=n.server??!0,n.default=n.default??F,n.lazy=n.lazy??!1,n.immediate=n.immediate??!0;const s=A(),o=()=>s.isHydrating?s.payload.data[e]:s.static.data[e],u=()=>o()!==void 0;s._asyncData[e]||(s._asyncData[e]={data:m(o()??n.default()),pending:m(!u()),error:k(s.payload._errors,e),status:m("idle")});const i={...s._asyncData[e]};i.refresh=i.execute=(l={})=>{if(s._asyncDataPromises[e]){if(l.dedupe===!1)return s._asyncDataPromises[e];s._asyncDataPromises[e].cancelled=!0}if((l._initial||s.isHydrating&&l._initial!==!1)&&u())return o();i.pending.value=!0,i.status.value="pending";const y=new Promise((c,p)=>{try{c(a(s))}catch(b){p(b)}}).then(c=>{if(y.cancelled)return s._asyncDataPromises[e];let p=c;n.transform&&(p=n.transform(c)),n.pick&&(p=M(p,n.pick)),i.data.value=p,i.error.value=null,i.status.value="success"}).catch(c=>{if(y.cancelled)return s._asyncDataPromises[e];i.error.value=c,i.data.value=S(n.default()),i.status.value="error"}).finally(()=>{y.cancelled||(i.pending.value=!1,s.payload.data[e]=i.data.value,i.error.value&&(s.payload._errors[e]=B(i.error.value)),delete s._asyncDataPromises[e])});return s._asyncDataPromises[e]=y,s._asyncDataPromises[e]};const h=()=>i.refresh({_initial:!0}),w=n.server!==!1&&s.payload.serverRendered;{const l=R();if(l&&!l._nuxtOnBeforeMountCbs){l._nuxtOnBeforeMountCbs=[];const c=l._nuxtOnBeforeMountCbs;l&&(C(()=>{c.forEach(p=>{p()}),c.splice(0,c.length)}),g(()=>c.splice(0,c.length)))}w&&s.isHydrating&&u()?(i.pending.value=!1,i.status.value=i.error.value?"error":"success"):l&&(s.payload.serverRendered&&s.isHydrating||n.lazy)&&n.immediate?l._nuxtOnBeforeMountCbs.push(h):n.immediate&&h(),n.watch&&O(n.watch,()=>i.refresh());const y=s.hook("app:data:refresh",c=>{if(!c||c.includes(e))return i.refresh()});l&&g(y)}const d=Promise.resolve(s._asyncDataPromises[e]).then(()=>i);return Object.assign(d,i),d}function X(...t){const r=typeof t[t.length-1]=="string"?t.pop():void 0;typeof t[0]!="string"&&t.unshift(r);const[e,a,n]=t;return H(e,a,{...n,lazy:!0},null)}function M(t,r){const e={};for(const a of r)e[a]=t[a];return e}const D=(t,r)=>r.split(".").reduce((e,a)=>e&&e[a],t),x=(t,r)=>Object.keys(t).filter(r).reduce((e,a)=>Object.assign(e,{[a]:t[a]}),{}),Y=t=>r=>Array.isArray(r)?r.map(e=>t(e)):t(r),$=t=>{const r=[],e=[];for(const a of t)["$","_"].includes(a)?r.push(a):e.push(a);return{prefixes:r,properties:e}},Z=(t=[])=>r=>{if(t.length===0||!r)return r;const{prefixes:e,properties:a}=$(t);return x(r,n=>!a.includes(n)&&!e.includes(n[0]))},ee=(t=[])=>r=>{if(t.length===0||!r)return r;const{prefixes:e,properties:a}=$(t);return x(r,n=>a.includes(n)||e.includes(n[0]))},te=(t,r)=>{const e=new Intl.Collator(r.$locale,{numeric:r.$numeric,caseFirst:r.$caseFirst,sensitivity:r.$sensitivity}),a=Object.keys(r).filter(n=>!n.startsWith("$"));for(const n of a)t=t.sort((s,o)=>{const u=[D(s,n),D(o,n)].map(i=>{if(i!==null)return i instanceof Date?i.toISOString():i});return r[n]===-1&&u.reverse(),e.compare(u[0],u[1])});return t},re=(t,r="Expected an array")=>{if(!Array.isArray(t))throw new TypeError(r)},f=t=>Array.isArray(t)?t:[void 0,null].includes(t)?[]:[t],Q=["sort","where","only","without"],K=(t,r)=>{const e={...r};for(const s of Q)e[s]&&(e[s]=f(e[s]));const a=(s,o=u=>u)=>(...u)=>(e[s]=o(...u),n),n={params:()=>({...e,...e.where?{where:[...f(e.where)]}:{},...e.sort?{sort:[...f(e.sort)]}:{}}),only:a("only",f),without:a("without",f),where:a("where",s=>[...f(e.where),...f(s)]),sort:a("sort",s=>[...f(e.sort),...f(s)]),limit:a("limit",s=>parseInt(String(s),10)),skip:a("skip",s=>parseInt(String(s),10)),find:()=>t(n),findOne:()=>(e.first=!0,t(n)),findSurround:(s,o)=>(e.surround={query:s,...o},t(n)),locale:s=>n.where({_locale:s})};return n};function E(t){return JSON.stringify(t,G)}function G(t,r){return r instanceof RegExp?`--REGEX ${r.toString()}`:r}const N=t=>{let r=E(t);return r=typeof Buffer<"u"?Buffer.from(r).toString("base64"):btoa(r),r=r.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),(r.match(/.{1,100}/g)||[]).join("/")},U=()=>async t=>{const{content:r}=P().public,e=t.params(),a=r.experimental.stripQueryParameters?v(`/query/${`${_(e)}.${r.integrity}`}/${N(e)}.json`):v(`/query/${_(e)}.${r.integrity}.json`);if(z())return(await I(()=>import("./client-db.bba24153.js"),["./client-db.bba24153.js","./entry.05eb57b8.js","./entry.d77b1f4d.css","./index.a6ef77ff.js","./preview.d255b37e.js","./utils.38b28f51.js"],import.meta.url).then(o=>o.useContentDatabase())).fetch(t);const n=await $fetch(a,{method:"GET",responseType:"json",params:r.experimental.stripQueryParameters?void 0:{_params:E(e),previewToken:q().getPreviewToken()}});if(typeof n=="string"&&n.startsWith("<!DOCTYPE html>"))throw new Error("Not found");return n};function ne(t,...r){const{content:e}=P().public,a=K(U(),typeof t!="string"?t:{});let n;typeof t=="string"&&(n=T(j(t,...r)));const s=a.params;return a.params=()=>{var u,i,h;const o=s();return n&&(o.where=o.where||[],o.first&&(o.where||[]).length===0?o.where.push({_path:L(n)}):o.where.push({_path:new RegExp(`^${n.replace(/[-[\]{}()*+.,^$\s/]/g,"\\$&")}`)})),(u=o.sort)!=null&&u.length||(o.sort=[{_file:1,$numeric:!0}]),e.locales.length&&((h=(i=o.where)==null?void 0:i.find(d=>d._locale))!=null&&h._locale||(o.where=o.where||[],o.where.push({_locale:e.defaultLocale}))),o},a}export{H as a,re as b,f as c,Y as d,N as e,ee as f,D as g,K as h,E as j,ne as q,te as s,X as u,Z as w};
